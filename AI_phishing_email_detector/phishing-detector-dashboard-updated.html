<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard AI - Chrome Extension</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            min-height: 600px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        /* Login Page Styles */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 600px;
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        .login-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
        }

        .auth-footer {
            margin-top: 20px;
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #e1e1e1;
        }

        .auth-footer p {
            color: #666;
            font-size: 14px;
        }

        .auth-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .auth-link:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .password-hint {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        .checkbox-group {
            margin-bottom: 25px !important;
        }

        .checkbox-label {
            display: flex !important;
            align-items: flex-start;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        .checkbox-label input[type="checkbox"] {
            width: auto !important;
            margin-right: 10px;
            margin-top: 2px;
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 14px;
            text-align: center;
        }

        .success-message {
            background: #efe;
            color: #363;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 14px;
            text-align: center;
        }

        /* Smooth transitions between forms */
        .container {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .container.fade-out {
            opacity: 0;
            transform: translateY(-20px);
        }

        .container.fade-in {
            opacity: 1;
            transform: translateY(0);
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
            height: 100%;
            min-height: 600px;
        }

        .dashboard.active {
            display: flex;
        }

        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 0;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 30px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 12px;
            opacity: 0.7;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            display: block;
            padding: 15px 25px;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            cursor: pointer;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: #667eea;
        }

        .nav-icon {
            display: inline-block;
            width: 20px;
            margin-right: 15px;
            text-align: center;
        }

        .main-content {
            flex: 1;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e1e8ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logout-btn {
            padding: 8px 16px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .content-area {
            flex: 1;
            padding: 30px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Email Management Styles */
        .email-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .email-input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .email-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-size: 14px;
        }

        .add-email-btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .email-list {
            display: grid;
            gap: 10px;
        }

        .email-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .email-address {
            font-weight: 500;
            color: #333;
        }

        .email-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        /* Future Features Section */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border: 2px dashed #e1e1e1;
            text-align: center;
            opacity: 0.7;
        }

        .feature-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .feature-card p {
            color: #666;
            font-size: 14px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .nav-menu {
                display: flex;
                overflow-x: auto;
                padding: 10px 0;
            }
            
            .nav-item {
                white-space: nowrap;
                border-left: none;
                border-bottom: 3px solid transparent;
            }
            
            .nav-item:hover, .nav-item.active {
                border-left: none;
                border-bottom-color: #667eea;
            }
        }
    </style>
</head>
<body>
    <!-- Sign In Container -->
    <div class="container" id="signinContainer">
        <div class="login-container">
            <div class="login-box">
                <div class="logo">🛡️</div>
                <h1 class="login-title">Welcome Back</h1>
                <p class="login-subtitle">Sign in to your PhishGuard AI account</p>
                
                <form id="signinForm">
                    <div class="form-group">
                        <label for="signinEmail">Email Address</label>
                        <input type="email" id="signinEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="signinPassword">Password</label>
                        <input type="password" id="signinPassword" name="password" required>
                    </div>
                    <button type="submit" class="login-btn">Sign In Securely</button>
                </form>
                
                <div class="auth-footer">
                    <p>Don't have an account? <a href="#" id="showSignup" class="auth-link">Create Account</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Sign Up Container -->
    <div class="container" id="signupContainer" style="display: none;">
        <div class="login-container">
            <div class="login-box">
                <div class="logo">🛡️</div>
                <h1 class="login-title">Create Account</h1>
                <p class="login-subtitle">Join PhishGuard AI for advanced email protection</p>
                
                <form id="signupForm">
                    <div class="form-group">
                        <label for="signupName">Full Name</label>
                        <input type="text" id="signupName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email Address</label>
                        <input type="email" id="signupEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" name="password" required minlength="6">
                        <div class="password-hint">Minimum 6 characters</div>
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm Password</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="agreeTerms" required>
                            <span class="checkmark"></span>
                            I agree to the <a href="#" class="auth-link">Terms of Service</a> and <a href="#" class="auth-link">Privacy Policy</a>
                        </label>
                    </div>
                    <button type="submit" class="login-btn">Create Account</button>
                </form>
                
                <div class="auth-footer">
                    <p>Already have an account? <a href="#" id="showSignin" class="auth-link">Sign In</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Container -->
    <div class="container dashboard" id="dashboardContainer">
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">PhishGuard AI</div>
                <div class="sidebar-subtitle">Chrome Extension Dashboard</div>
            </div>
            <nav class="nav-menu">
                <a class="nav-item active" data-section="overview">
                    <span class="nav-icon">📊</span>Overview
                </a>
                <a class="nav-item" data-section="emails">
                    <span class="nav-icon">📧</span>Email Management
                </a>
                <a class="nav-item" data-section="detection">
                    <span class="nav-icon">🔍</span>Phishing Detection
                </a>
                <a class="nav-item" data-section="reports">
                    <span class="nav-icon">📈</span>Reports & Analytics
                </a>
                <a class="nav-item" data-section="settings">
                    <span class="nav-icon">⚙️</span>Settings
                </a>
                <a class="nav-item" data-section="future">
                    <span class="nav-icon">🚀</span>Future Features
                </a>
            </nav>
        </div>

        <div class="main-content">
            <div class="header">
                <h1 class="header-title" id="pageTitle">Dashboard Overview</h1>
                <div class="user-info">
                    <span id="userEmail">user@example.com</span>
                    <button class="logout-btn" id="logoutBtn">Logout</button>
                </div>
            </div>

            <div class="content-area">
                <!-- Overview Section -->
                <div class="content-section active" id="overview">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="monitoredEmails">0</div>
                            <div class="stat-label">Monitored Emails</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">247</div>
                            <div class="stat-label">Emails Scanned Today</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">12</div>
                            <div class="stat-label">Threats Blocked</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">98.9%</div>
                            <div class="stat-label">Detection Accuracy</div>
                        </div>
                    </div>
                    
                    <div class="email-section">
                        <h2 class="section-title">Recent Activity</h2>
                        <p>Welcome to PhishGuard AI! Your AI-powered phishing protection is active and monitoring your registered email addresses for potential threats.</p>
                    </div>
                </div>

                <!-- Email Management Section -->
                <div class="content-section" id="emails">
                    <div class="email-section">
                        <h2 class="section-title">Add Email Address</h2>
                        <div class="email-input-group">
                            <input type="email" class="email-input" id="newEmailInput" placeholder="Enter email address to monitor">
                            <button class="add-email-btn" id="addEmailBtn">Add Email</button>
                        </div>
                    </div>
                    
                    <div class="email-section">
                        <h2 class="section-title">Monitored Email Addresses</h2>
                        <div class="email-list" id="emailList">
                            <!-- Dynamic email list will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Detection Section -->
                <div class="content-section" id="detection">
                    <div class="email-section">
                        <h2 class="section-title">AI Phishing Detection</h2>
<!-- AI Email Analysis Tool -->
<div class="email-section">
    <h2 class="section-title">AI Email Analysis</h2>
    <p>Paste suspicious email content below and let our AI analyze it for phishing risks.</p>
    
    <textarea id="emailContent" placeholder="Paste email text here..." 
        style="width: 100%; height: 150px; padding: 12px; border: 2px solid #e1e1e1; border-radius: 8px; margin-bottom: 15px;">
    </textarea>
    
    <button id="analyzeBtn" class="add-email-btn">Analyze Email</button>
    
    <div id="aiFeedback" 
        style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; display: none;">
    </div>
</div>

                        <p>Our advanced AI algorithms continuously analyze incoming emails for:</p>
                        <ul style="margin: 20px 0; padding-left: 20px; color: #666;">
                            <li>Suspicious sender patterns</li>
                            <li>Malicious links and attachments</li>
                            <li>Social engineering attempts</li>
                            <li>Domain spoofing</li>
                            <li>Content analysis for phishing indicators</li>
                        </ul>
                    </div>
                </div>

                <!-- Reports Section -->
                <div class="content-section" id="reports">
                    <div class="email-section">
                        <h2 class="section-title">Reports & Analytics</h2>
                        <p>Detailed reports and analytics will be available here, including threat trends, detection patterns, and security insights.</p>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="content-section" id="settings">
                    <div class="email-section">
                        <h2 class="section-title">Security Settings</h2>
                        <p>Configure your phishing detection preferences, notification settings, and security policies.</p>
                    </div>
                </div>

                <!-- Future Features Section -->
                <div class="content-section" id="future">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>🤖 Advanced ML Models</h3>
                            <p>Next-generation machine learning models for even better phishing detection accuracy</p>
                        </div>
                        <div class="feature-card">
                            <h3>📱 Mobile Integration</h3>
                            <p>Extend protection to mobile email apps with seamless synchronization</p>
                        </div>
                        <div class="feature-card">
                            <h3>🔗 Link Analysis</h3>
                            <p>Real-time URL reputation checking and link safety analysis</p>
                        </div>
                        <div class="feature-card">
                            <h3>👥 Team Management</h3>
                            <p>Enterprise features for managing multiple users and organizational policies</p>
                        </div>
                        <div class="feature-card">
                            <h3>📊 Advanced Analytics</h3>
                            <p>Comprehensive reporting with threat intelligence and trend analysis</p>
                        </div>
                        <div class="feature-card">
                            <h3>🔔 Smart Notifications</h3>
                            <p>Intelligent alerting system with customizable notification preferences</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Memory Storage System
        class MemoryStorage {
            constructor() {
                this.data = {
                    users: {},
                    sessions: {},
                    emailData: {}
                };
                this.currentSession = null;
            }

            // User Management
            createUser(email, password, name = '') {
                // Check if user already exists
                const existingUser = Object.values(this.data.users).find(u => u.email === email);
                if (existingUser) {
                    return null; // User already exists
                }

                const userId = this.generateId();
                this.data.users[userId] = {
                    id: userId,
                    name: name,
                    email: email,
                    password: password, // In real app, this would be hashed
                    createdAt: new Date().toISOString(),
                    lastLogin: null,
                    isActive: true
                };
                return userId;
            }

            authenticateUser(email, password) {
                const user = Object.values(this.data.users).find(u => u.email === email && u.password === password);
                if (user) {
                    user.lastLogin = new Date().toISOString();
                    this.createSession(user.id);
                    return user;
                }
                return null;
            }

            // Session Management
            createSession(userId) {
                const sessionId = this.generateId();
                this.currentSession = sessionId;
                this.data.sessions[sessionId] = {
                    id: sessionId,
                    userId: userId,
                    createdAt: new Date().toISOString(),
                    isActive: true
                };
                return sessionId;
            }

            getCurrentUser() {
                if (!this.currentSession) return null;
                const session = this.data.sessions[this.currentSession];
                if (!session || !session.isActive) return null;
                return this.data.users[session.userId];
            }

            logout() {
                if (this.currentSession) {
                    this.data.sessions[this.currentSession].isActive = false;
                    this.currentSession = null;
                }
            }

            // Email Management
            addMonitoredEmail(email) {
                const user = this.getCurrentUser();
                if (!user) return false;

                if (!this.data.emailData[user.id]) {
                    this.data.emailData[user.id] = {
                        monitoredEmails: [],
                        emailStats: {
                            totalScanned: 0,
                            threatsBlocked: 0,
                            lastScan: null
                        }
                    };
                }

                const emailEntry = {
                    email: email,
                    addedAt: new Date().toISOString(),
                    status: 'active',
                    scanCount: 0,
                    threatsDetected: 0
                };

                this.data.emailData[user.id].monitoredEmails.push(emailEntry);
                return true;
            }

            getMonitoredEmails() {
                const user = this.getCurrentUser();
                if (!user || !this.data.emailData[user.id]) return [];
                return this.data.emailData[user.id].monitoredEmails;
            }

            removeMonitoredEmail(email) {
                const user = this.getCurrentUser();
                if (!user || !this.data.emailData[user.id]) return false;

                const emails = this.data.emailData[user.id].monitoredEmails;
                const index = emails.findIndex(e => e.email === email);
                if (index !== -1) {
                    emails.splice(index, 1);
                    return true;
                }
                return false;
            }

            updateEmailStats(email, scanned = 0, threats = 0) {
                const user = this.getCurrentUser();
                if (!user || !this.data.emailData[user.id]) return false;

                const emailEntry = this.data.emailData[user.id].monitoredEmails.find(e => e.email === email);
                if (emailEntry) {
                    emailEntry.scanCount += scanned;
                    emailEntry.threatsDetected += threats;
                    
                    // Update overall stats
                    const stats = this.data.emailData[user.id].emailStats;
                    stats.totalScanned += scanned;
                    stats.threatsBlocked += threats;
                    stats.lastScan = new Date().toISOString();
                    
                    return true;
                }
                return false;
            }

            getEmailStats() {
                const user = this.getCurrentUser();
                if (!user || !this.data.emailData[user.id]) {
                    return { totalScanned: 0, threatsBlocked: 0, lastScan: null };
                }
                return this.data.emailData[user.id].emailStats;
            }

            // Utility Methods
            generateId() {
                return 'id_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
            }

            exportData() {
                return JSON.stringify(this.data, null, 2);
            }

            importData(jsonData) {
                try {
                    this.data = JSON.parse(jsonData);
                    return true;
                } catch (e) {
                    console.error('Failed to import data:', e);
                    return false;
                }
            }

            // Debug method to view all stored data
            viewAllData() {
                console.log('Memory Storage Data:', this.data);
                return this.data;
            }
        }

        // Initialize Memory Storage
        const storage = new MemoryStorage();

        // Create demo users for testing
        storage.createUser('demo@phishguard.ai', 'demo123', 'Demo User');
        storage.createUser('admin@phishguard.ai', 'admin123', 'Admin User');

        // Application State
        let currentUser = null;

        // DOM Elements
        const signinContainer = document.getElementById('signinContainer');
        const signupContainer = document.getElementById('signupContainer');
        const dashboardContainer = document.getElementById('dashboardContainer');
        
        const signinForm = document.getElementById('signinForm');
        const signupForm = document.getElementById('signupForm');
        const showSignupLink = document.getElementById('showSignup');
        const showSigninLink = document.getElementById('showSignin');
        
        const logoutBtn = document.getElementById('logoutBtn');
        const navItems = document.querySelectorAll('.nav-item');
        const contentSections = document.querySelectorAll('.content-section');
        const pageTitle = document.getElementById('pageTitle');
        const userEmail = document.getElementById('userEmail');
        const addEmailBtn = document.getElementById('addEmailBtn');
        const newEmailInput = document.getElementById('newEmailInput');
        const emailList = document.getElementById('emailList');
        const monitoredEmailsCount = document.getElementById('monitoredEmails');

        // Authentication Event Handlers
        
        // Show/Hide Forms
        showSignupLink.addEventListener('click', function(e) {
            e.preventDefault();
            showSignup();
        });

        showSigninLink.addEventListener('click', function(e) {
            e.preventDefault();
            showSignin();
        });

        // Sign In Functionality
        signinForm.addEventListener('submit', function(e) {
            e.preventDefault();
            clearMessages();
            
            const email = document.getElementById('signinEmail').value;
            const password = document.getElementById('signinPassword').value;
            
            // Authenticate user through memory storage
            const user = storage.authenticateUser(email, password);
            if (user) {
                currentUser = user;
                userEmail.textContent = user.name || user.email;
                showDashboard();
                loadUserData();
                showSuccessMessage('Welcome back! ' + `${user.name}`+'  Successfully signed in.', 'signinForm');
            } else {
                showErrorMessage('Invalid email or password. Try: demo@phishguard.ai / demo123', 'signinForm');
            }
        });

        // Sign Up Functionality
        signupForm.addEventListener('submit', function(e) {
            e.preventDefault();
            clearMessages();
            
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            
            // Validation
            if (!name) {
                showErrorMessage('Please enter your full name.', 'signupForm');
                return;
            }
            
            if (!isValidEmail(email)) {
                showErrorMessage('Please enter a valid email address.', 'signupForm');
                return;
            }
            
            if (password.length < 6) {
                showErrorMessage('Password must be at least 6 characters long.', 'signupForm');
                return;
            }
            
            if (password !== confirmPassword) {
                showErrorMessage('Passwords do not match.', 'signupForm');
                return;
            }
            
            if (!agreeTerms) {
                showErrorMessage('Please agree to the Terms of Service and Privacy Policy.', 'signupForm');
                return;
            }
            
            // Create user
            const userId = storage.createUser(email, password, name);
            if (userId) {
                showSuccessMessage('Account created successfully! You can now sign in.', 'signupForm');
                setTimeout(() => {
                    clearSignupForm();
                    showSignin();
                }, 2000);
            } else {
                showErrorMessage('An account with this email already exists.', 'signupForm');
            }
        });

        // Logout Functionality
        logoutBtn.addEventListener('click', function() {
            storage.logout();
            currentUser = null;
            showSignin();
            clearAllForms();
        });

        // Navigation
        navItems.forEach(item => {
            item.addEventListener('click', function() {
                const sectionId = this.getAttribute('data-section');
                showSection(sectionId);
                
                // Update active nav item
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
                
                // Update page title
                const titles = {
                    'overview': 'Dashboard Overview',
                    'emails': 'Email Management',
                    'detection': 'Phishing Detection',
                    'reports': 'Reports & Analytics',
                    'settings': 'Settings',
                    'future': 'Future Features'
                };
                pageTitle.textContent = titles[sectionId];
            });
        });

        // Email Management
        addEmailBtn.addEventListener('click', function() {
            const email = newEmailInput.value.trim();
            if (email && isValidEmail(email)) {
                // Check if email already exists
                const existingEmails = storage.getMonitoredEmails();
                if (existingEmails.some(e => e.email === email)) {
                    alert('This email is already being monitored');
                    return;
                }
                
                if (storage.addMonitoredEmail(email)) {
                    newEmailInput.value = '';
                    updateEmailList();
                    updateEmailCount();
                    updateStats();
                    
                    // Simulate some scanning activity
                    setTimeout(() => {
                        storage.updateEmailStats(email, Math.floor(Math.random() * 50) + 10, Math.floor(Math.random() * 3));
                        updateStats();
                    }, 1000);
                } else {
                    alert('Failed to add email. Please try again.');
                }
            } else {
                alert('Please enter a valid email address');
            }
        });

        // Enter key support for adding emails
        newEmailInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addEmailBtn.click();
            }
        });

        // Helper Functions
        function showSignin() {
            hideAllContainers();
            setTimeout(() => {
                signinContainer.style.display = 'flex';
                signinContainer.classList.add('fade-in');
            }, 150);
        }

        function showSignup() {
            hideAllContainers();
            setTimeout(() => {
                signupContainer.style.display = 'flex';
                signupContainer.classList.add('fade-in');
            }, 150);
        }

        function showDashboard() {
            hideAllContainers();
            setTimeout(() => {
                dashboardContainer.style.display = 'flex';
                dashboardContainer.classList.add('active', 'fade-in');
            }, 150);
        }

        function hideAllContainers() {
            [signinContainer, signupContainer, dashboardContainer].forEach(container => {
                container.classList.add('fade-out');
                setTimeout(() => {
                    container.style.display = 'none';
                    container.classList.remove('fade-out', 'fade-in', 'active');
                }, 150);
            });
        }

        function clearAllForms() {
            clearSigninForm();
            clearSignupForm();
            newEmailInput.value = '';
        }

        function clearSigninForm() {
            document.getElementById('signinEmail').value = '';
            document.getElementById('signinPassword').value = '';
        }

        function clearSignupForm() {
            document.getElementById('signupName').value = '';
            document.getElementById('signupEmail').value = '';
            document.getElementById('signupPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('agreeTerms').checked = false;
        }

        function showErrorMessage(message, formId) {
            clearMessages();
            const form = document.getElementById(formId);
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            form.insertBefore(errorDiv, form.firstChild);
        }

        function showSuccessMessage(message, formId) {
            clearMessages();
            const form = document.getElementById(formId);
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            form.insertBefore(successDiv, form.firstChild);
        }

        function clearMessages() {
            document.querySelectorAll('.error-message, .success-message').forEach(el => el.remove());
        }

        function loadUserData() {
            updateEmailList();
            updateEmailCount();
            updateStats();
        }

        function showSection(sectionId) {
            contentSections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function updateEmailList() {
            const emails = storage.getMonitoredEmails();
            emailList.innerHTML = '';
            
            emails.forEach((emailData, index) => {
                const emailItem = document.createElement('div');
                emailItem.className = 'email-item';
                const addedDate = new Date(emailData.addedAt).toLocaleDateString();
                emailItem.innerHTML = `
                    <div>
                        <div class="email-address">${emailData.email}</div>
                        <div style="font-size: 12px; color: #666; margin-top: 4px;">
                            Added: ${addedDate} | Scanned: ${emailData.scanCount} | Threats: ${emailData.threatsDetected}
                        </div>
                    </div>
                    <div class="email-status">
                        <span class="status-badge status-active">Active</span>
                        <button class="remove-btn" onclick="removeEmail('${emailData.email}')">Remove</button>
                    </div>
                `;
                emailList.appendChild(emailItem);
            });
            
            if (emails.length === 0) {
                emailList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No emails being monitored yet. Add an email address above to get started.</p>';
            }
        }

        function removeEmail(email) {
            if (confirm('Are you sure you want to stop monitoring this email address?')) {
                if (storage.removeMonitoredEmail(email)) {
                    updateEmailList();
                    updateEmailCount();
                    updateStats();
                } else {
                    alert('Failed to remove email. Please try again.');
                }
            }
        }

        function updateEmailCount() {
            const emails = storage.getMonitoredEmails();
            monitoredEmailsCount.textContent = emails.length;
        }

        function updateStats() {
            const stats = storage.getEmailStats();
            
            // Update stats in overview
            const totalScannedEl = document.querySelector('.stat-card:nth-child(2) .stat-number');
            const threatsBlockedEl = document.querySelector('.stat-card:nth-child(3) .stat-number');
            
            if (totalScannedEl) totalScannedEl.textContent = stats.totalScanned;
            if (threatsBlockedEl) threatsBlockedEl.textContent = stats.threatsBlocked;
        }

        // Debug function to view storage data (can be called from browser console)
        function debugStorage() {
            return storage.viewAllData();
        }

        // Export/Import functions for future use
        function exportData() {
            const data = storage.exportData();
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'phishguard-data.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function importData(jsonData) {
            return storage.importData(jsonData);
        }

        
// AI Email Analysis Event Listener
document.getElementById("analyzeBtn").addEventListener("click", async () => {
    const emailContent = document.getElementById("emailContent").value.trim();
    const feedbackBox = document.getElementById("aiFeedback");

    if (!emailContent) {
        alert("Please paste an email to analyze.");
        return;
    }

    feedbackBox.style.display = "block";
    feedbackBox.innerHTML = "Analyzing email... ⏳";

    try {
        const response = await fetch("/api/analyze-email", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ emailContent })
        });

        const result = await response.json();
        feedbackBox.innerHTML = `<strong>AI Feedback:</strong><br>${result.feedback}`;
    } catch (error) {
        feedbackBox.innerHTML = "❌ Error analyzing email. Please try again.";
    }
});


        // Initialize the application
        showLogin();
    </script>
</body>
</html>